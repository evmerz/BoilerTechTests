<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<link rel="stylesheet" href="../styles/navigation.css">
	<link rel="stylesheet" href="../styles/global.css">
	<link rel="stylesheet" href="../styles/login.css">

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link
		href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,100..900;1,9..144,100..900&display=swap"
		rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&display=swap"
		rel="stylesheet">

	<title>Login - BoilerTechTests</title>
</head>

<body style="overflow: hidden; height: 100vh">
	<div id="top-border"></div>

	<div id="navbar">
		<div id="logo-container">
			<h2 id="logo-text">
				<a style="text-decoration: none; color: inherit;" href="javascript:delay('/index.html', 500)">
					&#128642;B<span id="logo-hide">oiler</span>T<span id="logo-hide">ech</span>T<span id="logo-hide">ests</span>
				</a>
			</h2>
		</div>

		<!-- Spacer for navbar -->
		<div id="nav-spacer" style="flex: 1;"></div>

		<div id="link-container">
			<a href="/index.html" class="hoverable-text">home</a>
			<a href="/index.html" class="hoverable-text">practice</a>
			<a href="/index.html" class="hoverable-text">awards</a>
			<a href="/index.html" class="hoverable-text">tutoring</a>
			<a href="../pages/pythonTerminal.html" class="hoverable-text">terminal</a>
			<a href="../pages/about.html" class="hoverable-text">about</a>

			<a href="../pages/login.html" class="hoverable-svg">
				<img src="../images/account_circle.svg">
			</a>
		</div>

	</div>

	<div id="shadow"></div>

	<div id="sidebar">
		<div id="toggle" onclick="show()">
			<span></span>
			<span style="margin-top: 0.25em;"></span>
			<span style="margin-top: 0.25em;"></span>
		</div>

		<div id="link-container">
			<div class="sidebar-text"><a class="underlineable" href="javascript:delay('/index.html', 500)">home</a></div>
			<div class="sidebar-text"><a class="underlineable" href="javascript:delay('/index.html', 500)">practice</a></div>
			<div class="sidebar-text"><a class="underlineable" href="javascript:delay('/index.html', 500)">awards</a></div>
			<div class="sidebar-text"><a class="underlineable" href="javascript:delay('/index.html', 500)">tutoring</a></div>
			<div class="sidebar-text"><a class="underlineable"
					href="javascript:delay('../pages/pythonTerminal.html', 500)">terminal</a></div>
			<div class="sidebar-text"><a class="underlineable" href="javascript:delay('/index.html', 500)">about</a></div>

			<div id="logos">
				<a href="../pages/login.html"><img src="../images/account_circle_white.svg"></a>
			</div>
		</div>
	</div>

	<!-- ================================ MAIN CONTAINER FOR WEBSITE ================================ -->
	<div class="container">
		<!-- Include spacers wherever you deem necessary -->
		<div id="spacer"></div>

		<!-- ======== Always use sub-containers for the actual content to maintain proper spacing ======== -->
		<div class="sub-container" >
			
			<div id="login-container">
				<form id="login-form">
					<h2 class="fade-in">Login</h2>
					<div class="fade-in" style="--delay: 0.1s;">
						<input type="text" id="username" name="username" placeholder="Username" required />
						<input type="password" id="password" name="password" placeholder="Password" required />
					</div>
					<button class="button fade-in" style="width: 50%; --delay: 0.15s;" type="submit">Log In</button>

					<p class="fade-in" style="--delay: 0.3s">
						Don't have an account?
						<a href="create.html" style="text-decoration: none;">Create Account</a>
					</p>
					<p id="response-message"></p>
				</form>
			</div>
		</div>
	</div>

	<script src="https://code.jquery.com/jquery-3.7.1.min.js"
		integrity="sha384-1H217gwSVyLSIfaLxHbE7dRb3v4mYCKbpQvzx0cegeju1MVsGrX5xXxAvs/HgeFs"
		crossorigin="anonymous"></script>
	<script src="../scripts/navigation.js"></script>

	<script>
		document.getElementById('login-form').addEventListener('submit', function (event) {
			event.preventDefault(); // Prevent the form from refreshing the page

			const username = document.getElementById('username').value;
			const password = document.getElementById('password').value;

			const url = `http://boilertechtests.com/api/login?username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`;

			fetch(url, {
				method: 'GET',
			})
				.then(response => {
					if (!response.ok) {
						return response.json().then(errorData => {
							throw new Error(errorData.message);
						});
					}
					return response.json();
				})
				.then(data => {
					document.getElementById('response-message').textContent = data.message;
					if (data.message === "Login successful") {
						// Store user ID in local storage
						localStorage.setItem('userId', data.userId);
						// Redirect to about.html after a short delay
						setTimeout(() => {
							window.location.href = 'create.html';
						}, 1000); // 1 second delay
					}
				})
				.catch(error => {
					document.getElementById('response-message').textContent = 'Error: ' + error.message;
				});
		});
	</script>

</body>

</html>